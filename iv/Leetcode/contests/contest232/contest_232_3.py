import heapq
from heapq import heapify
import time


class Solution:
    def maxAverageRatio(self, classes: list, extraStudents: int) -> float:
        h = [(a / b - (a + 1) / (b + 1), a, b) for a, b in classes]
        heapify(h)
        while extraStudents:
            v, a, b = heapq.heappop(h)
            a, b = a + 1, b + 1
            heapq.heappush(h, (-(a + 1) / (b + 1) + a / b, a, b))
            extraStudents -= 1
        return sum(a / b for v, a, b in h) / len(h)

    def maxAverageRatio2(self, classes: list, extraStudents: int) -> float:
        res = []
        for i in range(len(classes)):
            a, b = classes[i][0], classes[i][1]
            res.append([(a+1)/(b+1) - a/b, i])
        while extraStudents > 0:
            extraStudents -= 1
            # print(res)
            res.sort(reverse=True)
            i = res[0][1]
            classes[i] = [classes[i][0] + 1, classes[i][1] + 1]
            a, b = classes[i][0], classes[i][1]
            res[0][0] = (a+1)/(b+1) - a/b
        return self.avgratio(classes)



    def maxAverageRatio3(self, classes: list, extraStudents: int) -> float:

        while extraStudents > 0:
            extraStudents -= 1
            res = []
            for i in range(len(classes)):
                x = classes[i][0] + 1
                y = classes[i][1] + 1
                # print(x,y)
                classes[i] = [x,y]
                # print(classes)
                res.append([self.avgratio(classes), classes[:]])
                classes[i] = [x - 1, y - 1]

            res.sort(reverse=True)
            classes = res[0][1]
            # print(res)
        return self.avgratio(classes)

    def avgratio(self, classes):
        per = 0
        for i, j in classes:
            per += float(i) / float(j)
        return per/len(classes)


classes = [[1,2],[3,5],[2,2]]; extraStudents = 2
classes = [[2,4],[3,9],[4,5],[2,10]]; extraStudents = 4
classes = [[547,616],[419,932],[121,677],[285,303],[255,388],[573,768],[5,983],[195,542],[450,593],[22,32],[643,997],[249,621],[267,856],[178,212],[152,292],[206,556],[280,319],[600,776],[257,853],[458,700],[811,882],[829,876],[173,997],[366,559],[431,503],[125,877],[214,788],[585,901],[210,393],[291,831],[111,926],[25,827],[121,583],[14,766],[304,559],[691,989],[742,780],[665,997],[77,140],[383,513],[587,825],[319,448],[516,694],[366,777],[332,542],[1,127],[453,736],[359,461],[313,553],[348,409],[749,802],[586,700],[116,505],[664,940],[387,392],[209,571],[4,285],[613,651],[740,903],[757,850],[524,746],[204,946],[473,616],[530,855],[419,960],[730,763],[313,720],[175,461],[635,685],[203,544],[369,539],[4,695],[399,594],[437,994],[345,415],[637,882],[599,998]]
extraStudents = 5554
# classes = [[245,435],[77,381],[542,547],[178,789],[62,793],[554,695],[45,286],[7,571],[600,764],[489,921],[427,925],[197,607],[116,805],[362,728],[344,880],[513,516],[606,764],[618,772],[679,780],[169,265],[593,759],[292,876],[823,931],[304,500],[332,522],[517,662],[439,628],[50,114],[67,891],[66,925],[320,630],[432,658],[382,396],[337,591],[92,722],[151,852],[890,916],[571,581],[452,763],[428,517],[231,568],[803,893],[260,761],[345,425],[320,672],[43,178],[116,951],[103,737],[125,449],[487,743],[719,777],[358,883],[123,283],[322,392],[125,990],[169,533],[547,756],[460,749],[518,817],[91,881],[351,511],[128,578],[101,330],[102,791],[250,565],[249,508],[498,976],[46,346],[171,859],[64,884],[16,439],[340,702],[313,568],[638,975],[252,754],[364,851],[150,703],[797,945],[768,883],[784,943],[73,648],[193,959],[36,799],[181,848],[779,785],[367,726],[447,976],[697,994],[216,270],[165,215],[416,775],[540,874],[180,190],[245,847],[147,476],[630,636],[783,947],[626,789],[289,578],[165,332],[694,977],[328,948],[556,956],[588,637],[247,289],[831,867],[171,200],[891,919],[33,289],[134,146],[27,947],[54,447],[359,871],[460,736],[149,883],[222,439],[161,959],[367,558],[179,753],[71,756],[269,736],[344,381],[50,531],[313,702],[160,951],[740,972],[493,616],[54,662],[830,946],[477,647],[428,796],[628,836],[19,90],[9,997],[45,787],[17,30],[221,792],[209,379],[462,937],[46,721],[51,227],[306,931],[206,573],[184,786],[198,848],[587,849],[204,381],[221,545],[139,746],[582,727],[103,883],[165,322],[559,824],[476,643],[891,945],[512,678],[24,556],[70,490],[14,466],[328,587],[925,939],[355,368],[422,946],[147,721],[112,128],[474,899],[674,831],[334,899],[846,950],[171,865],[72,663],[22,395],[455,517],[1,682],[622,774],[139,304],[288,811],[62,312],[487,488],[63,582],[153,821],[1,510],[422,611],[38,250],[120,748],[398,689],[551,990],[29,537],[597,908],[316,973],[7,847],[24,247],[544,894],[652,733],[286,395],[373,643],[743,982],[6,219],[631,923],[440,739],[219,740],[464,515],[51,788],[133,901],[829,887],[555,640],[277,660],[35,960],[869,873],[100,406],[98,969],[50,507],[614,960],[154,502],[115,717],[257,501],[62,187],[111,546],[74,476],[188,960],[346,1000],[478,770],[161,548],[500,728],[384,753],[264,910],[706,782],[305,911],[879,926],[177,496],[310,677],[30,536],[181,250],[108,759],[79,399],[125,303],[812,832],[102,718],[260,960],[227,679],[178,781],[371,704],[110,461],[102,331],[533,560],[68,458],[445,597],[90,539],[115,616],[480,614],[263,484],[391,477],[389,485],[100,393],[342,386],[641,803],[11,719],[71,178],[837,940],[441,505],[31,891],[88,750],[398,703],[520,613],[41,339],[782,869],[28,517],[1,669],[462,767],[863,879],[180,543],[310,464],[417,732],[80,519],[631,744],[210,934],[326,438],[504,795],[440,662],[401,682],[32,643],[584,726],[542,741],[572,657],[105,176],[415,785],[559,805],[159,975],[261,958],[221,507],[141,761],[352,742],[562,745],[654,975],[106,162],[611,723],[663,827],[20,505],[319,959],[39,910],[560,677],[100,276],[505,738],[161,421],[258,882],[302,361],[260,332],[191,537],[605,979],[220,877],[635,639],[553,964],[112,619],[161,259],[124,208],[46,702],[141,704],[534,769],[646,995],[597,930],[781,847],[647,698],[737,965],[465,694],[657,755],[570,939],[118,553],[573,778],[182,254],[428,432],[615,786],[41,170],[337,708],[13,817],[329,882],[728,774],[152,175],[378,846],[253,878],[876,889],[597,677],[44,924],[731,922],[746,811],[851,950],[429,872],[672,901],[161,335],[220,601],[250,641],[289,493],[277,600],[532,658],[518,733],[582,956],[773,929],[514,926],[230,494],[772,900],[893,894],[774,998],[166,864],[68,727],[256,580],[143,466],[173,386],[22,714],[97,883],[59,756],[35,930],[575,863],[57,846],[511,627],[476,772],[25,744],[269,505],[283,291],[391,749],[122,491],[90,863],[319,914],[387,647],[446,874],[202,967],[241,540],[71,158],[710,991],[736,875],[297,744],[212,815],[104,946],[359,783],[141,276],[227,367],[164,360],[761,784],[107,1000],[108,750],[202,311],[242,834],[68,650],[43,964],[341,617],[750,898],[219,387],[374,898],[626,702],[79,724],[471,775],[340,479],[300,700],[341,697],[535,798],[20,906],[89,523],[132,170],[21,948],[28,851],[210,254],[770,907],[700,718],[746,747],[318,443],[190,655],[110,991],[385,981],[539,920],[10,538],[202,627],[69,224],[164,321],[209,794],[743,807],[325,823],[235,269],[356,402],[326,735],[51,848],[205,467],[698,773],[113,473],[160,925],[387,400],[213,322],[244,348],[479,508],[409,747],[980,998],[5,984],[361,478],[659,850],[649,919],[346,493],[57,454],[402,693],[623,714],[594,689],[488,500],[704,726],[62,295],[474,515],[96,238],[659,949],[310,976],[167,664],[217,462],[167,274],[310,555],[402,743],[867,965],[7,193],[579,613],[15,492],[300,651],[760,937],[272,795],[568,817],[79,266],[926,931],[400,773],[48,584],[566,716],[40,983],[201,713],[485,942],[781,1000],[222,405],[307,332],[499,639],[263,525],[728,826],[270,618],[165,406],[414,512],[892,909],[879,887],[571,832],[232,242],[417,613],[77,458],[733,781],[58,397],[2,707],[195,874],[202,361],[109,715],[39,900],[484,843],[56,196],[183,686],[44,324],[686,855],[262,518],[196,212],[418,823],[922,987],[67,540],[184,588],[47,262],[845,976],[149,870],[15,736],[776,834],[61,812],[568,607],[221,768],[180,336],[144,891],[177,705],[414,977],[594,793],[2,3],[595,987],[342,857],[519,835],[663,950],[28,780],[221,833],[82,790],[494,757],[76,476],[919,920],[175,277],[532,956],[848,998],[19,812],[424,866],[299,598],[574,599],[186,206],[101,328],[589,745],[299,837],[725,979],[206,311],[532,579],[13,115],[288,842],[213,962],[222,778],[241,556],[204,937],[511,887],[326,409],[619,808],[494,742],[108,986],[77,381],[259,477],[488,751],[21,62],[341,490],[11,709],[253,564],[51,129],[99,405],[55,238],[308,631],[106,379],[99,906],[283,288],[738,901],[157,242],[552,762],[160,621],[58,489],[422,451],[31,733],[13,340],[445,641],[306,500],[53,739],[326,452],[436,645],[27,173],[288,372],[70,247],[149,627],[328,715],[405,555],[555,599],[317,721],[544,774],[331,784],[376,822],[145,500],[215,631],[221,427],[107,771],[84,947],[176,926],[16,651],[22,974],[85,466],[541,847],[76,584],[191,368],[540,811],[570,647],[178,928],[188,755],[78,427],[112,474],[3,971],[494,790],[374,663],[414,751],[148,598],[143,373],[243,613],[335,399],[194,983],[811,923],[544,936],[650,799],[547,989],[103,965],[317,451],[212,594],[703,942],[156,465],[55,263],[953,987],[168,202],[503,713],[910,965],[202,553],[44,410],[353,645],[490,520],[898,902],[843,873],[227,426],[200,884],[641,800],[16,83],[160,859],[507,815],[618,736],[221,509],[276,967],[127,404],[72,518],[101,356],[173,204],[438,702],[318,420],[264,945],[533,791],[649,944],[252,387],[35,418],[41,768],[198,743],[382,416],[330,783],[284,420],[463,726],[180,402],[132,713],[358,441],[695,721],[375,877],[593,788],[383,513],[36,446],[377,777],[127,343],[55,218],[628,763],[367,955],[184,570],[598,780],[745,957],[294,859],[512,574],[179,434],[378,895],[381,839],[897,983],[32,171],[188,840],[368,628],[706,812],[482,719],[642,1000],[457,701],[197,554],[126,329],[672,865],[762,935],[17,439],[228,920],[450,959],[317,431],[82,283],[204,570],[115,464],[40,654],[799,881],[5,711],[546,797],[587,924],[230,246],[33,620],[511,686],[210,340],[196,852],[30,114],[711,781],[307,641],[288,719],[97,137],[380,461],[434,999],[338,869],[820,852],[770,841],[64,734],[312,521],[86,475],[164,228],[580,593],[215,601],[300,537],[603,773],[588,672],[294,482],[288,697],[102,565],[667,975],[260,912],[166,182],[539,768],[171,609],[440,979],[310,709],[407,956],[238,408],[172,932],[176,422],[576,833],[339,556],[250,949],[223,797],[153,295],[687,721],[77,650],[78,839],[246,708],[119,665],[313,770],[11,136],[406,416],[993,999],[649,877],[58,128],[54,618],[135,477],[405,926],[300,896],[163,245],[240,482],[599,653],[231,621],[258,999],[537,783],[428,827],[472,594],[577,720],[136,289],[652,675],[526,885],[133,829],[34,923],[134,650],[158,546],[10,599],[259,531],[560,562],[179,736],[36,356],[493,895],[559,829],[191,627],[238,334],[666,909],[650,775],[189,724],[217,692],[177,895],[580,823],[505,680],[254,756],[129,214],[48,527],[343,829],[253,415],[469,736],[272,875],[187,730],[46,120],[38,90],[294,511],[52,124],[320,646],[830,879],[380,617],[818,957],[245,355],[217,263],[195,933],[167,348],[286,884],[676,888],[331,756],[372,940],[38,80],[219,866],[178,404],[469,662],[215,636],[13,475],[388,407],[357,978],[380,704],[505,909],[615,860],[9,617],[259,664],[80,768],[679,831],[60,870],[415,939],[417,966],[383,817],[411,723],[190,312],[201,654],[629,787],[92,872],[31,312],[40,435],[469,843],[6,414],[208,559],[629,854],[488,807],[263,849],[25,613],[712,764],[215,939],[229,701],[143,669],[783,976],[613,719],[340,804],[246,645],[270,340],[37,395],[18,297],[480,647],[27,986],[17,436],[112,855],[178,959],[255,679],[20,415],[857,942],[456,622],[158,797],[79,220]]
# extraStudents = 62514
# .5, .33..8, .2
c = [[3,5],[4,10],[4,5],[3,11]]
s = Solution()
a = time.time()
print(s.maxAverageRatio(classes, extraStudents))
b = time.time()
print(s.maxAverageRatio2(classes, extraStudents))
c = time.time()
print(s.maxAverageRatio3(classes, extraStudents))
d = time.time()
print(b -a)
print(c-b)
print(d-c)
# print(s.avgratio(c))

